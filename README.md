[![Analytics](https://ga-beacon.appspot.com/UA-46795389-1/cartos-gs/README)](https://github.com/igrigorik/ga-beacon)

# Cartos-GS

Cartos-GS is a collection of [Google App Scripts](https://developers.google.com/apps-script/) used to build charts in Google Spreadsheets using the data generated by [Cartos](https://github.com/madtrick/cartos)

## Including Cartos-GS into your Google App Script project
You have two choices for including this library into your project:

  * Clone this repo and export the scripts whitin to your own project.
  * Or use my version of this scripts as a library. My library project key is: **MWMCD18JWyOOfyEIYbY3lUEyPLvOuZnZa**. Check the [libraries](https://developers.google.com/apps-script/guide_libraries) section of the Google App Script documentation for more info.

## Usage

You have to create a config object and pass it to ```CartosGS.init```. This configuration object must be like this:

    {
      /*
       * 'tmpSheet' is the name of the sheet Cartos-GS will create
       * to store temporary data used to build the charts
       * It can be any name.
      */
      tmpSheet : ,

      /*
       * 'charts' is an array of objects that describe the charts
       * that will be created by Cartos-GS. Cartos-GS understands
       * three types of objects: categories, months and custom
       *
      */
      charts : [
        {
          type : "categories",
          tags : [], // The name of the tags that you want to create charts for
          sheetName : "", // The name of the sheet where the charts will be inserted
          composers : [] // The composers for each one the charts that you want to show
        },
        { 
          type   : "months",
          months : [], // The months that you want to create charts for
          tags   : [], // The name of the tags that will be included for the charts of each month
          sheetName : "", //The name of the sheet where the charts will be inserted
          composers : [], // The composers for each one the charts that you want to show
        },
        {
          type : "custom",
          builder : //The builder that will articulate the creation of the charts for this custom builder
        }
      ]
    }

Once the config is created, you can use it in any function that calls ```CartosGS.init```. For example:

    function run(){
      var config = {...};
      CartosGS.init(config);
    }

For an example of its usage, take a look at the [Google App Script Project](https://script.google.com/macros/d/Mb7k-f1sZW0cbVlTPDjLPl7IhsAF9HQMl/edit?uiv=2&tz=Europe/Paris&docTitle=Cartos+example&csid=tKyFmjdJxFsj8K2EbGqD2nw.06986732065420958553.4194379637318946999&mid=ACjPJvGpW780pJ7Wdm8BfF3QzUpkhzT3kU3Nhj5GiDnKW3WttmN0KXpvAHmmXaDTgcp75NhI5OtV4b_ukCm_v65XnCx69JJ7-X1NUJpTSDCAAsI5Lhso&hl=en_US) for the example spreadsheet that uses Cartos.

## Import and export Google App Script code

This projects also includes a Rakefile to import and export the App Script code from/to Google and your computer (following the directives given [here](https://developers.google.com/apps-script/import-export)). This Rakefile includes two tasks:

      $ rake -T
      rake export  # Exports the scripts in the current working dir to a project in https://script.google.com 
      rake import  # Imports into the current working dir the scripts from a project in https://script.google.com 

For this to work, the script will request (only the first time you run it) several config values:

  * ```oauth.client_id```. If you don't have an API client_id for Google APIs you have to create one in [https://code.google.com/apis/console](https://code.google.com/apis/console) (take a look at [https://developers.google.com/drive/about-auth](https://developers.google.com/drive/about-auth) for more info).
  * ```oauth.client_secret```. The same as for ```oauth.client_id```.
  * ```project.id```. The id of the project in [https://script.google.com](https://script.google.com) where you want to import/export your Google App Scripts. You can get this id in the project's URL:

      ![Project id](https://raw.github.com/madtrick/cartos-gs/screenshots/GS-project-id.png)

  * ```oauth.authorization_code```: The authorization code that will be granted to you after allowing the access of the Rakefile to some Google API operations.
